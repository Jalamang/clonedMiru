{"ast":null,"code":"var _jsxFileName = \"/Users/jalamangjankagmail.com/8-0/module-6/Miru/front-end/src/components/Comments.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { instance } from \"../helpers/api\";\nimport { Comment } from \"./Comment\";\nimport \"./Comments.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Comments(_ref) {\n  _s();\n\n  let {\n    setImages\n  } = _ref;\n  const {\n    id\n  } = useParams();\n  const [comments, setComments] = useState([]);\n  const [editedCommentId, setEditedCommentId] = useState(null);\n  const [comment, setComment] = useState({\n    comment: \"\"\n  });\n  useEffect(() => {\n    handleLoad();\n  }, []);\n\n  const handleLoad = () => {\n    instance.get(`/activity/${id}/comments`).then(response => {\n      setComments(response.data);\n    }).catch(error => console.warn(error));\n  };\n\n  const handleTextChange = event => {\n    setComment({ ...comment,\n      [event.target.id]: event.target.value\n    });\n  };\n\n  const onSubmit = event => {\n    event.preventDefault();\n    instance.post(`/activity/${id}/comments`, comment).then(response => {\n      setImages(comment.images);\n      handleLoad();\n    }).catch(error => console.warn(error));\n    setComment({\n      comment: \"\"\n    });\n  };\n\n  const handleEditSubmit = comment => {\n    instance.put(`/activity/${id}/comments/${editedCommentId}`, comment).then(response => {\n      if (response.data.id) {\n        setEditedCommentId(null);\n        handleLoad();\n      } else {\n        alert(\"must include input\");\n      }\n    });\n  };\n\n  const handleDelete = idOfDeleted => {\n    instance.delete(`/activity/${id}/comments/${idOfDeleted}`).then(response => {\n      handleLoad();\n    }).catch(error => console.warn(error));\n  };\n\n  const handleCommentEdit = comment => {\n    setEditedCommentId(comment.id);\n  };\n\n  const handleCancelCommentEdit = comment => {\n    setEditedCommentId(null);\n  };\n\n  const getBase64Update = file => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = _ => resolve(reader.result);\n\n      reader.onerror = e => reject(e);\n    });\n  };\n\n  const onchange = event => {\n    let files = Array.from(event.target.files);\n    files = files.map(async file => ({\n      content: await getBase64Update(file),\n      fileName: file.name,\n      contentType: file.type,\n      length: file.size\n    }));\n    Promise.all(files).then(result => {\n      setComment({ ...comment,\n        images: result\n      });\n    });\n  };\n\n  const allComments = comments.map((comment, i) => {\n    return /*#__PURE__*/_jsxDEV(Comment, {\n      comment: comment,\n      edit: editedCommentId === comment.id,\n      onEditFn: handleCommentEdit,\n      onCancelFn: handleCancelCommentEdit,\n      onEditSubmit: handleEditSubmit,\n      onDeleteFn: handleDelete,\n      userId: comment.user_id,\n      currentUser: comment.currentUser\n    }, comment.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this);\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"CommentSection\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"CommentForm\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: onSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"Comment\",\n          children: \"Comment:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"comment\",\n          value: comment.comment,\n          type: \"textarea\",\n          onChange: handleTextChange,\n          placeholder: \"Comment...\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-outline\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form-label\",\n            htmlFor: \"image\",\n            children: [\" \", \"Image:\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            multiple: true,\n            type: \"file\",\n            id: \"image\",\n            onChange: onchange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), allComments]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Comments, \"AGRTtSSZ3b+FY7nVt1zljhNsGkQ=\", false, function () {\n  return [useParams];\n});\n\n_c = Comments;\nexport default Comments;\n\nvar _c;\n\n$RefreshReg$(_c, \"Comments\");","map":{"version":3,"names":["useState","useEffect","useParams","instance","Comment","Comments","setImages","id","comments","setComments","editedCommentId","setEditedCommentId","comment","setComment","handleLoad","get","then","response","data","catch","error","console","warn","handleTextChange","event","target","value","onSubmit","preventDefault","post","images","handleEditSubmit","put","alert","handleDelete","idOfDeleted","delete","handleCommentEdit","handleCancelCommentEdit","getBase64Update","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","_","result","onerror","e","onchange","files","Array","from","map","content","fileName","name","contentType","type","length","size","all","allComments","i","user_id","currentUser"],"sources":["/Users/jalamangjankagmail.com/8-0/module-6/Miru/front-end/src/components/Comments.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { instance } from \"../helpers/api\";\nimport { Comment } from \"./Comment\";\nimport \"./Comments.css\";\n\nfunction Comments({ setImages }) {\n  const { id } = useParams();\n\n  const [comments, setComments] = useState([]);\n  const [editedCommentId, setEditedCommentId] = useState(null);\n  const [comment, setComment] = useState({\n    comment: \"\",\n  });\n\n  useEffect(() => {\n    handleLoad();\n  }, []);\n\n  const handleLoad = () => {\n    instance\n      .get(`/activity/${id}/comments`)\n      .then((response) => {\n        setComments(response.data);\n      })\n\n      .catch((error) => console.warn(error));\n  };\n\n  const handleTextChange = (event) => {\n    setComment({ ...comment, [event.target.id]: event.target.value });\n  };\n\n  const onSubmit = (event) => {\n    event.preventDefault();\n\n    instance\n      .post(`/activity/${id}/comments`, comment)\n      .then((response) => {\n        setImages(comment.images);\n\n        handleLoad();\n      })\n      .catch((error) => console.warn(error));\n    setComment({\n      comment: \"\",\n    });\n  };\n\n  const handleEditSubmit = (comment) => {\n    instance.put(`/activity/${id}/comments/${editedCommentId}`, comment).then((response) => {\n      if (response.data.id) {\n        setEditedCommentId(null);\n        handleLoad();\n      } else {\n        alert(\"must include input\");\n      }\n    });\n  };\n\n  const handleDelete = (idOfDeleted) => {\n    instance\n      .delete(`/activity/${id}/comments/${idOfDeleted}`)\n      .then((response) => {\n        handleLoad();\n      })\n\n      .catch((error) => console.warn(error));\n  };\n\n  const handleCommentEdit = (comment) => {\n    setEditedCommentId(comment.id);\n  };\n\n  const handleCancelCommentEdit = (comment) => {\n    setEditedCommentId(null);\n  };\n\n  const getBase64Update = (file) => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = (_) => resolve(reader.result);\n      reader.onerror = (e) => reject(e);\n    });\n  };\n\n  const onchange = (event) => {\n    let files = Array.from(event.target.files);\n    files = files.map(async (file) => ({\n      content: await getBase64Update(file),\n      fileName: file.name,\n      contentType: file.type,\n      length: file.size,\n    }));\n    Promise.all(files).then((result) => {\n      setComment({ ...comment, images: result });\n    });\n  };\n\n  const allComments = comments.map((comment, i) => {\n    return (\n      <Comment\n        key={comment.id}\n        comment={comment}\n        edit={editedCommentId === comment.id}\n        onEditFn={handleCommentEdit}\n        onCancelFn={handleCancelCommentEdit}\n        onEditSubmit={handleEditSubmit}\n        onDeleteFn={handleDelete}\n        userId={comment.user_id}\n        currentUser={comment.currentUser}\n      />\n    );\n  });\n\n  return (\n    <div className=\"CommentSection\">\n      <div className=\"CommentForm\">\n        <form onSubmit={onSubmit}>\n          <label htmlFor=\"Comment\">Comment:</label>\n          <input\n            id=\"comment\"\n            value={comment.comment}\n            type=\"textarea\"\n            onChange={handleTextChange}\n            placeholder=\"Comment...\"\n            required\n          />\n\n          <div className=\"form-outline\">\n            <label className=\"form-label\" htmlFor=\"image\">\n              {\" \"}\n              Image:\n            </label>\n            <input multiple type=\"file\" id=\"image\" onChange={onchange} />\n          </div>\n\n          <button type=\"submit\">Submit</button>\n        </form>\n      </div>\n      {allComments}\n    </div>\n  );\n}\n\nexport default Comments;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}